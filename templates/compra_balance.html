<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Compra Saldo</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
    min-height:100vh;
    background:#1e1e1e;
    font-family:monospace;
    color:#fff;
    overflow-y:auto;      /* FIX */
    overflow-x:hidden;
    touch-action:auto;    /* FIX */
}

/* HEADER */
header{
    width:100%;
    background:#0f1720;
    border-bottom:1px solid #2b2b2b;
    display:flex;
    justify-content:center;
    align-items:center;
    padding:16px 0;
}

.logo img{
    width:80px;
    height:80px;
    border-radius:50%;
    background:#fff;
    box-shadow:
        0 0 10px #8a2be2,
        0 0 40px #8a2be2;
}

/* CONTAINER */
.container{
    width:100%;
    max-width:420px;
    margin:20px auto 40px; /* FIX */
    padding:16px;
}

/* CARD */
.card{
    background:#111827;
    border-radius:14px;
    padding:20px;
    box-shadow:0 10px 30px rgba(0,0,0,.5);
    display:flex;
    flex-direction:column;
    gap:12px;
}

.card h4{
    text-align:center;
    font-size:20px;
    margin-bottom:6px;
    color:#a78bfa;
}

/* INFO */
.info{
    display:flex;
    justify-content:space-between;
    font-size:14px;       /* FIX */
    border-bottom:1px solid #2b2b2b;
    padding-bottom:6px;
    gap:8px;
}

.info span{
    word-break:break-word; /* FIX */
}

/* VALOR */
.valor{
    text-align:center;
    font-size:24px;
    font-weight:bold;
    margin:10px 0;
    color:#22c55e;
}

/* BOT√ÉO */
.purchase{
    width:100%;
    min-height:56px;
    background:linear-gradient(135deg,#6366f1,#8b5cf6);
    color:#fff;
    border:0;
    border-radius:10px;
    font-size:16px;       /* FIX */
}

/* MOBILE (Samsung A10) */
@media (max-width: 360px){
    header{padding:12px 0}
    .logo img{width:70px;height:70px}
    .card{padding:16px}
    .valor{font-size:22px}
    .purchase{font-size:15px}
}
</style>
</head>

<body>

<header>
    <div class="logo">
        <img src="https://res.cloudinary.com/doik0qtfr/image/upload/v1765756283/file_000000001b0071f58bcbc51e9c9d664d_rnlva3.png">
    </div>
</header>

<div class="container">
    <div class="card">
        <h4>Pagamentos</h4>

        <div class="info"><span>Nome</span><span id="nome">{{nome}}</span></div>
        <div class="info"><span>Email</span><span id="email">{{email}}</span></div>
        <div class="info"><span>CPF</span><span id="cpf">{{cpf}}</span></div>
        <div class="info"><span>Telefone</span><span id="telefone">{{telefone}}</span></div>
        <div class="info"><span>Quantidade</span><span id="qtd">1</span></div>

        <div class="valor">R$ <span id="valor">{{valor}}</span></div>

        <button class="purchase" id="link-pagar-preference">
            Gerar Pagamento
        </button>
    </div>
</div>

<script>
document.getElementById("link-pagar-preference").onclick = async () => {
    const nome = document.getElementById("nome").innerText;
    const email = document.getElementById("email").innerText;
    const cpf = document.getElementById("cpf").innerText;
    const telefone = document.getElementById("telefone").innerText;
    const qtd = document.getElementById("qtd").innerText;

    const url = `/compra/preference/pagamento_pix/{{ user_id }}?nome=${encodeURIComponent(nome)}&email=${encodeURIComponent(email)}&cpf=${encodeURIComponent(cpf)}&telefone=${encodeURIComponent(telefone)}&qtd=${encodeURIComponent(qtd)}`;

    const resposta = await fetch(url);
    const link = await resposta.text();
    window.location.href = link;
};
</script>

</body>
</html>
