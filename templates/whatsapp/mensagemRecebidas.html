<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mensagens Recebidas</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family: Arial, Helvetica, sans-serif;
}

html,body{
    height:100%;
}

body{
    overflow:hidden;
}

.container{
    height:100%;
    display:flex;
    flex-direction:column;
    background:#fff;
}

/* topo */
.header{
    background:#075e54;
    color:#fff;
    padding:15px;
    text-align:center;
    flex-shrink:0;
}

/* lista */
.list{
    flex:1;
    overflow-y:auto;
    padding-bottom:80px; /* espaço pro painel */
}

.item{
    display:flex;
    align-items:center;
    padding:15px;
    border-bottom:1px solid #eee;
    text-decoration:none;
    color:#000;
}

.item:hover{
    background:#f5f5f5;
}

.avatar{
    width:50px;
    height:50px;
    border-radius:50%;
    margin-right:15px;
    object-fit:cover;
}

.info{
    flex:1;
}

.name{
    font-weight:bold;
    font-size:1rem;
}

.preview{
    font-size:.8rem;
    color:#777;
}

.time{
    font-size:.7rem;
    color:#999;
}

/* painel fixo */
.panel{
    position:fixed;
    bottom:0;
    left:0;
    width:100%;
    height:70px;
    background:#fff;
    border-top:1px solid #ddd;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 15px;
    z-index:20;
}

.attach-menu{
    position:absolute;
    bottom:120px;
    left:10px;
    display:none;
    flex-direction:column;
    gap:10px;
}

.attach-menu button{
    width:50px;
    height:50px;
    border-radius:50%;
    border:none;
    cursor:pointer;
    font-size:20px;
}


.cloud-btn{
    width:50px;
    height:50px;
    border-radius:50%;
    background:#075e54;
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:1.3rem;
}

.me{
    width:45px;
    height:45px;
    border-radius:50%;
    object-fit:cover;
}
</style>
</head>

<body>
<div class="container">

    <div class="header">
        <h3>Mensagens Recebidas</h3>
    </div>

    <div class="list">
        {% for chat in mensagens %}
        <a href="/msg/privado/{{ chat.user_id }}" class="item">
            <img src="https://i.pravatar.cc/150?u={{ chat.user_id }}" class="avatar">
            <div class="info">
                <div class="name">{{ chat.nome or chat.email or "Usuário" }}</div>
                <div class="preview">{{ chat.ultima_mensagem }}</div>
            </div>
            <div class="time">{{ chat.hora }}</div>
        </a>
        {% endfor %}
    </div>

</div>

<div class="panel">
 <div class="attach-menu" id="attachMenu">
             <button id="contactButton" disabled>
               <a href="/contatos/users/{{ user_id }}" style="all: unset; cursor: pointer;">
                 <i class="fas fa-user"></i>
               </a>
             </button>

              <button id="contactButton" disabled>
               <a href="/game/{{ user_id }}" style="all: unset; cursor: pointer;">
                 <i class="fas fa-user"></i>
               </a>
             </button>
      
    </div>
    <div class="cloud-btn">
     <i class="fa-solid fa-cloud"></i>
    </div>
    <img src="https://i.pravatar.cc/150?u={{ user_id }}" class="me" onclick="toggleAttach()">
</div>

<script>
// ====================== MENU DE ANEXOS ======================
function toggleAttach(){
    const menu = document.getElementById('attachMenu');
    menu.style.display = menu.style.display === 'flex' ? 'none' : 'flex';
}

if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(()=>{});
    });
}
</script>

</body>
</html>
